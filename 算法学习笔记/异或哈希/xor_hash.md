# 异或哈希（xor hash）

~~疑惑哈希~~

由于异或具有交换律等许多很涩的性质。可以用于快速找到**一个组合是否出现、序列中的数是否出现了$k$次**，但如果数据比较小，异或出来的值很可能一样，因此需要将原始数据哈希为较大的数**降低**冲突概率。有机会将一个检查，查找需要$O(n)$的东西优化成$O(1)$。

## 一个组合是否出现

一个组合是否出现很好理解，我们先把原序列的每一个数随机一个哈希值，一个组合的值定义为其元素的异或和。若异或和相等就认为两个组合相等。



## 序列中的数是否出现了$k$次--K进制异或

普通异或可以看成，不进位加法，也就是模2意义下的加法，我们推广到模$k$意义下的不不进位加法，那么显然$tk$个数异或起来为0。如何判断一个集合内所有的数都出现恰好$k$次？在保证集合中每个数出现次数小于等于$k$的基础上，$k$进制异或和为0即可。考虑什么时候为$0$，显然若$pre[r]==pre[l]$，那么$[l+1,r]$的异或值为0 。

## $x^2$问题

要让一个序列所有数乘起来是一个形如$x^2$的数。根据算数基本定理有
$$
x^k =\prod p_i^{k \alpha_i}
$$
我们想到将素数赋随机 Hash 值，设 *f*(*x*) 为 *x* 分解素因数后每个素因数 Hash 值的异或和（多个相同素因数重复算）。*f*(*x*)=0 当且仅当 *x* 是平方数（在很高概率下）。



