# 萝莉控都能学会的组合计数

> 以题目为中心。

## [P3807 【模板】卢卡斯定理/Lucas 定理](https://www.luogu.com.cn/problem/P3807)

### Lucass定理

对于素数$p$，有
$$
\binom{n}{k}\equiv \binom{\left\lfloor  \frac{n}{p} \right\rfloor}{\left\lfloor  \frac{k}{p} \right\rfloor} \binom{n \mod p} {k \mod p} \mod p
$$

#### 证明：

考虑利用
$$
(1+x)^n =(1+x)^{p \left\lfloor  \frac{n}{p} \right\rfloor} (1+x)^{n \mod p}
$$
注意到
$$
\binom{p}{n} =[n=0 \or p=n] \mod p
$$
那么对于
$$
\begin{aligned}
(ax^n+bx^m)^p&=\sum_{k=0}^{p} \binom{p}{k} (ax^n)^k(bx^m)^{p-k}\\
&\equiv a^px^{np}+b^px^{mp}\\
&\equiv ax^{np}+bx^{mp} \quad \text{费马小定理}
\end{aligned}
$$
于是有
$$
\begin{aligned}
(1+x)^n &=(1+x)^{p \left\lfloor  \frac{n}{p} \right\rfloor} (1+x)^{n \mod p}\\
&=(1+x^p)^{\left\lfloor  \frac{n}{p} \right\rfloor} (1+x)^{n \mod p}
\end{aligned}
$$
显然有
$$
\binom{n}{k}\equiv \binom{\left\lfloor  \frac{n}{p} \right\rfloor}{\left\lfloor  \frac{k}{p} \right\rfloor} \binom{n \mod p} {k \mod p} \mod p
$$

## [CF1545B AquaMoon and Chess](https://codeforces.com/problemset/problem/1545/B)（对应法）

因为原来的移动规则非常复杂，考虑简化移动规则。

注意到相邻两个1绑定后是可以随便移动的。

若绑定后没有单独的1，那么显然我们可以将两个1压缩，这样的方案和原始的方案是一一对应的。

若有单独的1，假设有$a$个11，b个10，c个0。我们选完a的位置后，实际上b，c的位置就完全确定了。因为b和c不能换位置。

注意末尾的单个1可以忽略不计。

> 实际上将单个1和0结合，等价于固定单个1一定在最右边。

